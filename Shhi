#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct patient {
    int patientid;
    char patientname[50];
    int patientage;
    char patientillness[100];
    struct patient* next;
};

void himikomenu();
void himikoaddpatient(struct patient** head, int patientid, char patientname[], int patientage, char patientillness[]);
struct patient* himikocreatepatient(int patientid, char patientname[], int patientage, char patientillness[]);

void himikomenu() {
    struct patient* head = NULL;
    int himikochoice, patientid, patientage, srchid;
    char patientname[50], patientillness[100];

    while (1) {
        system("cls");
        printf("==== Patient Management System ====\n");
        printf("[1] Add patient\n");
        printf("[2] Display all patients\n");
        printf("[3] Search patient by ID\n");
        printf("[4] Delete patient by ID\n");
        printf("[5] LOG OUT\n");
        printf("\nEnter choice: ");
        scanf("%d", &himikochoice);
        getchar();

        switch (himikochoice) {
            case 1:
                system("cls");
                printf("Enter ID: ");
                scanf("%d", &patientid);
                getchar();

                printf("Enter Name: ");
                fgets(patientname, sizeof(patientname), stdin);
                patientname[strcspn(patientname, "\n")] = '\0';

                printf("Enter Age: ");
                scanf("%d", &patientage);
                getchar();

                printf("Enter Illness: ");
                fgets(patientillness, sizeof(patientillness), stdin);
                patientillness[strcspn(patientillness, "\n")] = '\0';

                himikoaddpatient(&head, patientid, patientname, patientage, patientillness);

                printf("\nPatient information successfully saved.\n");
                printf("Press Enter to continue...");
                getchar();
                break;

            case 2:
            	system("cls");
                displaypatiens(head);
                break;

            case 3:
            	system("cls");
                printf("Enter ID to Search: ");
            	scanf("%d", &srchid);
            	getchar();
            	searchpatients(head, srchid);
            	pauseConsole();
                break;

            case 4:
            	system("cls");
                printf("Enter ID to Delete: ");
            	scanf("%d", &srchid);
            	getchar();
            	deletepatients(&head, srchid);
            	pauseConsole();
                break;

            case 5:
                printf("Exiting...\n");
                exit(0);

            default:
                printf("\nInvalid choice\n");
                printf("Press Enter to continue...");
                getchar();
                break;
        }
    }
}

void himikoaddpatient(struct patient** head, int patientid, char patientname[], int patientage, char patientillness[]) {
    struct patient* himikonewpatient = himikocreatepatient(patientid, patientname, patientage, patientillness);

    if (*head == NULL) {
        *head = himikonewpatient;
        return;
    }

    struct patient* himikoTemp = *head;
    while (himikoTemp->next != NULL) {
        himikoTemp = himikoTemp->next;
    }

    himikoTemp->next = himikonewpatient;
}

struct patient* himikocreatepatient(int patientid, char patientname[], int patientage, char patientillness[]) {
    struct patient* himikonewpatient = (struct patient*)malloc(sizeof(struct patient));

    himikonewpatient->patientid = patientid;
    strcpy(himikonewpatient->patientname, patientname);
    himikonewpatient->patientage = patientage;
    strcpy(himikonewpatient->patientillness, patientillness);
    himikonewpatient->next = NULL;

    return himikonewpatient;
}

void pauseConsole(){
	printf("\n Press any Key to Continue");
	getchar(); getchar();
}

void searchpatients(struct patient* head, int scrhid){
	while(head != NULL)
	if(head->patientid == srchid){
	system("cls");
		printf("ID: %d\n", head->patientid);
		printf("Patient Name: %s\n", head->patientname);
		printf("Age: %d\n", head->patientage);
		printf("Patient Illness: %s\n", head->patientillness);
		printf("============");
		return;
		}
		head = head ->next;
}
	printf("\n No ID of %d is Found.", srchid);
	
void deletepatients(struct patient** head, srchid){
    struct patient* prev = NULL;
    struct patient* temp = *head;
    
    if(currenttemp!= NULL && temp->patientid == srchid){
    	*head = temp->next;
    	free(temp);
    	printf("\nPatient with &d is Deleted");
    	return;
	}
	while(temp != NULL && temp->patientid != srchid){
		prev = temp;
		temp = temp->patientid;
	}
	if(temp == NULL){
		printf("Patent with ID %d is not Found.");
		return;
	}
	prev->next = temp ->next;
	free(temp);
	printf("\nPatient with ID %d is Deleted.");
}
void displaypatients(struct patient* head){
	if(head == NULL){
		system("cls");
		printf("\n No Patients Found.");
		pauseConsole();
		return;
	}
	system("cls");
	printf("===== Patients Information ======\n");
	while ( head!= NULL ){
		printf("ID: %d\n", head->patientid);
		printf("Patient Name: %s\n", head->patientname);
		printf("Age: %d\n", head->patientage);
		printf("Patient Illness: %s\n", head->patientillness);
		printf("============");
		head = head->next;
	}
	pauseConsole();
}

int main(int argc, char *argv[]) {
    char himikousername[] = "admin";
    char himikopassword[] = "admin123";
    char himikoinuname[50];
    char himikoinpass[50];

    printf("Username: ");
    scanf("%s", himikoinuname);

    printf("Password: ");
    scanf("%s", himikoinpass);

    if (strcmp(himikousername, himikoinuname) == 0 && strcmp(himikopassword, himikoinpass) == 0) {
        system("cls");
        himikomenu();
    } else {
        printf("Invalid login.\n");
    }

    return 0;
}
